<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to geocodebr • geocodebr</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to geocodebr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">geocodebr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/geocodebr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/geocoding_en.html">Geocoding with geocodebr (ENG)</a></li>
    <li><a class="dropdown-item" href="../articles/geocoding_pt.html">Geolocalização com geocodebr (PORT)</a></li>
    <li><a class="dropdown-item" href="../articles/reverse_geocoding.html">Reverse-geocoding (ENG)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/geocodebr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to geocodebr</h1>
            
            <h4 data-toc-skip class="date">2025-01-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/geocodebr/blob/main/vignettes/geocodebr.Rmd" class="external-link"><code>vignettes/geocodebr.Rmd</code></a></small>
      <div class="d-none name"><code>geocodebr.Rmd</code></div>
    </div>

    
    
<p>Geocoding refers to the act of finding a point in space, usually
represented by a pair of coordinates, given a street address. The
<strong>geocodebr</strong> packages allows one to efficiently geocode
Brazilian addresses using the National Registry of Addresses for
Statistical Purposes (english for <em>Cadastro Nacional de Endereços
para Fins Estatísticos</em>, CNEFE)[^1], a data set collected and <a href="https://www.ibge.gov.br/estatisticas/sociais/populacao/38734-cadastro-nacional-de-enderecos-para-fins-estatisticos.html" class="external-link">published</a>
by the Brazilian official statistics and geography office, IBGE,
containing the addresses of more than 100 million households and
establishments in Brazil.</p>
<div class="section level3">
<h3 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<p>Before using <em>geocodebr</em>, please make sure you have it
installed in your computer. You can download either the most stable
version from CRAN…</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"geocodebr"</span><span class="op">)</span></span></code></pre></div>
<p>… or the development version from GitHub.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"ipeaGIT/geocodebr"</span><span class="op">)</span></span></code></pre></div>
<p>Then attach it to the current R session:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/geocodebr" class="external-link">geocodebr</a></span><span class="op">)</span></span></code></pre></div>
<p>The main entry point to the package’s functionalities is
<code><a href="../reference/geocode.html">geocode()</a></code>, which takes a data frame of addresses as input
and outputs the same data frame with the latitude and longitude of each
matched address, as well as two columns indicating the precision level
of the matches. To demonstrate its usage, the package includes a few
sample data sets in the installation. In the example below, we use a
small data set that contains addresses with commonly seen issues, such
as missing information and mistyped fields.</p>
<p><strong>Note:</strong> Running the function for the first time may
take a while, since <em>geocodebr</em> needs to download the CNEFE data,
which sums up to about 5.5 GB. Alternatively, you can use
<code><a href="../reference/download_cnefe.html">download_cnefe()</a></code> to download the data before geocoding
(<code><a href="../reference/geocode.html">geocode()</a></code> does that behind the scenes).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input_addresses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/small_sample.csv"</span>, package <span class="op">=</span> <span class="st">"geocodebr"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">geocodebr</span><span class="fu">::</span><span class="fu"><a href="../reference/geocode.html">geocode</a></span><span class="op">(</span></span>
<span>  <span class="va">input_addresses</span>,</span>
<span>  address_fields <span class="op">=</span> <span class="fu">geocodebr</span><span class="fu">::</span><span class="fu"><a href="../reference/setup_address_fields.html">setup_address_fields</a></span><span class="op">(</span></span>
<span>    logradouro <span class="op">=</span> <span class="st">"nm_logradouro"</span>,</span>
<span>    numero <span class="op">=</span> <span class="st">"Numero"</span>,</span>
<span>    cep <span class="op">=</span> <span class="st">"Cep"</span>,</span>
<span>    bairro <span class="op">=</span> <span class="st">"Bairro"</span>,</span>
<span>    municipio <span class="op">=</span> <span class="st">"nm_municipio"</span>,</span>
<span>    estado <span class="op">=</span> <span class="st">"nm_uf"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The input of the field 'number' has observations with non numeric characters.</span></span>
<span><span class="co">#&gt; These observations were transformed to NA.</span></span>
<span><span class="co">#&gt; Warning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id            nm_logradouro Numero       Cep               Bairro</span></span>
<span><span class="co">#&gt; 1  1 RUA MARIA LUCIA PACIFICO     17 26042-730           SANTA RITA</span></span>
<span><span class="co">#&gt; 2  2      RUA LEOPOLDINA TOME     46 25030-050           CENTENARIO</span></span>
<span><span class="co">#&gt; 3  3          RUA DONA JUDITE      0 23915-700          CAPUTERA II</span></span>
<span><span class="co">#&gt; 4  4     RUA ALEXANDRE AMARAL      0 23098-120           SANTISSIMO</span></span>
<span><span class="co">#&gt; 5  5                AVENIDA E    300 23860-000         PRAIA GRANDE</span></span>
<span><span class="co">#&gt; 6  6      RUA PRINCESA ISABEL    263 69921-026 ESTACAO EXPERIMENTAL</span></span>
<span><span class="co">#&gt;      nm_municipio code_muni          nm_uf       lon        lat match_type</span></span>
<span><span class="co">#&gt; 1     NOVA IGUACU   3303500 RIO DE JANEIRO -43.47118 -22.695496       en01</span></span>
<span><span class="co">#&gt; 2 DUQUE DE CAXIAS   3301702 RIO DE JANEIRO -43.31134 -22.779173       en01</span></span>
<span><span class="co">#&gt; 3  ANGRA DOS REIS   3300100 RIO DE JANEIRO -44.20841 -22.978631       ei01</span></span>
<span><span class="co">#&gt; 4  RIO DE JANEIRO   3304557 RIO DE JANEIRO -43.51047 -22.870022       ei01</span></span>
<span><span class="co">#&gt; 5     MANGARATIBA   3302601 RIO DE JANEIRO -43.97214 -22.929864       en01</span></span>
<span><span class="co">#&gt; 6      RIO BRANCO   1200401           ACRE -67.83559  -9.963436       en01</span></span>
<span><span class="co">#&gt;            precision</span></span>
<span><span class="co">#&gt; 1             numero</span></span>
<span><span class="co">#&gt; 2             numero</span></span>
<span><span class="co">#&gt; 3 numero_interpolado</span></span>
<span><span class="co">#&gt; 4 numero_interpolado</span></span>
<span><span class="co">#&gt; 5             numero</span></span>
<span><span class="co">#&gt; 6             numero</span></span></code></pre></div>
<p>obs. Note that the first time the user runs this function,
{geocodebr} will download a few files and store them locally. This way,
the data only needs to be downloaded once. More info about data caching
below.</p>
<p>The output coordinates use the official geodetic reference system
used in Brazil: SIRGAS2000, CRS(4674). The results of {geocodebr} are
classified into six broad <code>precision</code> categories depending on
how exactly each input address was matched with CNEFE data. The accuracy
of the results are indicated in two columns of the output:
<code>precision</code> and <code>match_type</code>. More information
below.</p>
</div>
<div class="section level2">
<h2 id="precision-categories">Precision categories:<a class="anchor" aria-label="anchor" href="#precision-categories"></a>
</h2>
<p>The results of {geocodebr} are classified into six broad
<code>precision</code> categories:</p>
<ul>
<li>“numero”</li>
<li>“numero_interpolado”</li>
<li>“rua”</li>
<li>“cep”</li>
<li>“bairro”</li>
<li>“municipio”</li>
<li>
<code>NA</code> (not found)</li>
</ul>
<p>Each precision level can be disaggregated into more refined match
types.</p>
<div class="section level3">
<h3 id="match-type">Match Type<a class="anchor" aria-label="anchor" href="#match-type"></a>
</h3>
<p>The column <code>match_type</code> provides more refined information
on how exactly each input address was matched with CNEFE. In every
category, {geocodebr} takes the average latitude and longitude of the
addresses included in CNEFE that match the input address based on
combinations of different fields. In the strictest case, for example,
the function finds a deterministic match for all of the fields of a
given address (<code>"estado"</code>, <code>"municipio"</code>,
<code>"logradouro"</code>, <code>"numero"</code>, <code>"cep"</code>,
<code>"localidade"</code>). Think for example of a building with several
apartments that match the same street address and number. In such case,
the coordinates of the apartments will differ very slightly, and
{geocodebr} takes the average of those coordinates. In a less rigorous
example, in which only the fields (<code>"estado"</code>,
<code>"municipio"</code>, <code>"logradouro"</code>,
<code>"localidade"</code>) are matched, {geocodebr} calculates the
average coordinates of all the addresses in CNEFE along that street and
which fall within the same neighborhood.</p>
<p>The complete list of precision levels, their corresponding match type
categories and the fields considered in each category are described
below:</p>
<ul>
<li>precision: <strong>“numero”</strong>
<ul>
<li>match_type:
<ul>
<li>en01: logradouro, numero, cep e bairro</li>
<li>en02: logradouro, numero e cep</li>
<li>en03: logradouro, numero e bairro</li>
<li>en04: logradouro e numero</li>
<li>pn01: logradouro, numero, cep e bairro</li>
<li>pn02: logradouro, numero e cep</li>
<li>pn03: logradouro, numero e bairro</li>
<li>pn04: logradouro e numero</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“numero_interpolado”</strong>
<ul>
<li>match_type:
<ul>
<li>ei01: logradouro, numero, cep e bairro</li>
<li>ei02: logradouro, numero e cep</li>
<li>ei03: logradouro, numero e bairro</li>
<li>ei04: logradouro e numero</li>
<li>pi01: logradouro, numero, cep e bairro</li>
<li>pi02: logradouro, numero e cep</li>
<li>pi03: logradouro, numero e bairro</li>
<li>pi04: logradouro e numero</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“rua”</strong> (when input number is missing
‘S/N’)
<ul>
<li>match_type:
<ul>
<li>er01: logradouro, cep e bairro</li>
<li>er02: logradouro e cep</li>
<li>er03: logradouro e bairro</li>
<li>er04: logradouro</li>
<li>pr01: logradouro, cep e bairro</li>
<li>pr02: logradouro e cep</li>
<li>pr03: logradouro e bairro</li>
<li>pr04: logradouro</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“cep”</strong>
<ul>
<li>match_type:
<ul>
<li>ec01: municipio, cep, localidade</li>
<li>ec02: municipio, cep</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“bairro”</strong>
<ul>
<li>match_type:
<ul>
<li>eb01: municipio, localidade</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“municipio”</strong>
<ul>
<li>match_type:
<ul>
<li>em01: municipio</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong><em>Note:</em></strong> Match types starting with ‘p’ use
probabilistic matching of the logradouro field, while types starting
with ‘e’ use deterministic matching only. <strong>Match types with
probabilistic matching are not implemented in {geocodebr}
yet</strong>.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-cache">Data cache<a class="anchor" aria-label="anchor" href="#data-cache"></a>
</h2>
<p>The first time the user runs the <code><a href="../reference/geocode.html">geocode()</a></code> function,
{geocodebr} will download a few reference files and store them locally.
This way, the data only needs to be downloaded once. Mind you that these
files require approximately 4GB of space in your local drive.</p>
<p>The package includes the following functions to help users manage
cached files:</p>
<ul>
<li>
<code><a href="../reference/get_cache_dir.html">get_cache_dir()</a></code>: returns the path to where the cached
data is stored. By default, files are cached in the package
directory.</li>
<li>
<code><a href="../reference/set_cache_dir.html">set_cache_dir()</a></code>: set a custom directory to be used.
This configuration is persistent across different R sessions.</li>
<li>
<code><a href="../reference/list_cached_data.html">list_cached_data()</a></code>: list all files currently
cached</li>
<li>
<code><a href="../reference/clean_cache_dir.html">clean_cache_dir()</a></code>: delete all files of the cache
directory used by {geocodebr}</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Herszenhut, Rafael H. M. Pereira, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
