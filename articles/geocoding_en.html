<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Geocoding with geocodebr (ENG) • geocodebr</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Geocoding with geocodebr (ENG)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">geocodebr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/geocodebr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/geocoding_en.html">Geocoding with geocodebr (ENG)</a></li>
    <li><a class="dropdown-item" href="../articles/geocoding_pt.html">Geolocalização com geocodebr (PORT)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/geocodebr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Geocoding with geocodebr (ENG)</h1>
            
            <h4 data-toc-skip class="date">2025-01-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/geocodebr/blob/main/vignettes/geocoding_en.Rmd" class="external-link"><code>vignettes/geocoding_en.Rmd</code></a></small>
      <div class="d-none name"><code>geocoding_en.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="geocoding-from-addresses-to-spatial-coordinates">Geocoding: from addresses to spatial coordinates<a class="anchor" aria-label="anchor" href="#geocoding-from-addresses-to-spatial-coordinates"></a>
</h2>
<p>Once you have a table (<code>data.frame</code>) with addresses,
geolocating the data with <strong>{geocodebr}</strong> can be done in
two simple steps:</p>
<ol style="list-style-type: decimal">
<li>The first step is to use the <code><a href="../reference/setup_address_fields.html">setup_address_fields()</a></code>
function to declare the names of the columns in your input
<code>data.frame</code> that correspond to each field of the
addresses.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/geocodebr" class="external-link">geocodebr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read input sample data</span></span>
<span><span class="va">input_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/small_sample.csv"</span>, package <span class="op">=</span> <span class="st">"geocodebr"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1st step: indicate the columns describing the address fields</span></span>
<span><span class="va">fields</span> <span class="op">&lt;-</span> <span class="fu">geocodebr</span><span class="fu">::</span><span class="fu"><a href="../reference/setup_address_fields.html">setup_address_fields</a></span><span class="op">(</span></span>
<span>  logradouro <span class="op">=</span> <span class="st">"nm_logradouro"</span>,</span>
<span>  numero <span class="op">=</span> <span class="st">"Numero"</span>,</span>
<span>  cep <span class="op">=</span> <span class="st">"Cep"</span>,</span>
<span>  bairro <span class="op">=</span> <span class="st">"Bairro"</span>,</span>
<span>  municipio <span class="op">=</span> <span class="st">"nm_municipio"</span>,</span>
<span>  estado <span class="op">=</span> <span class="st">"nm_uf"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>The second step is to use the <code><a href="../reference/geocode.html">geocode()</a></code> function to
find the geographic coordinates of input addresses.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2nd step: geocode</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">geocodebr</span><span class="fu">::</span><span class="fu"><a href="../reference/geocode.html">geocode</a></span><span class="op">(</span></span>
<span>  addresses_table <span class="op">=</span> <span class="va">input_df</span>,</span>
<span>  address_fields <span class="op">=</span> <span class="va">fields</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id            nm_logradouro Numero       Cep               Bairro</span></span>
<span><span class="co">#&gt; 1  1 Rua Maria Lucia Pacifico     17 26042-730           Santa Rita</span></span>
<span><span class="co">#&gt; 2  2      Rua Leopoldina Tome     46 25030-050           Centenario</span></span>
<span><span class="co">#&gt; 3  3          Rua Dona Judite      0 23915-700          Caputera II</span></span>
<span><span class="co">#&gt; 4  4     Rua Alexandre Amaral      0 23098-120           Santissimo</span></span>
<span><span class="co">#&gt; 5  5                Avenida E    300 23860-000         Praia Grande</span></span>
<span><span class="co">#&gt; 6  6      Rua Princesa Isabel    263           Estacao Experimental</span></span>
<span><span class="co">#&gt;      nm_municipio code_muni nm_uf        lat       lon match_type precision</span></span>
<span><span class="co">#&gt; 1     Nova Iguacu   3303500    RJ -22.695496 -43.47118       en01    number</span></span>
<span><span class="co">#&gt; 2 Duque de Caxias   3301702    RJ -22.779173 -43.31134       en01    number</span></span>
<span><span class="co">#&gt; 3  Angra dos Reis   3300100    RJ -22.978837 -44.20848       er01    street</span></span>
<span><span class="co">#&gt; 4  Rio de Janeiro   3304557    RJ -22.868992 -43.51150       er01    street</span></span>
<span><span class="co">#&gt; 5     Mangaratiba   3302601    RJ -22.929864 -43.97214       en01    number</span></span>
<span><span class="co">#&gt; 6      Rio Branco   1200401    AC  -9.963436 -67.83559       en03    number</span></span></code></pre></div>
<p>obs. Note that the first time the user runs this function,
{geocodebr} will download a few files and store them locally. This way,
the data only needs to be downloaded once. More info about data caching
below.</p>
<p>The output coordinates use the official geodetic reference system
used in Brazil: SIRGAS2000, CRS(4674). The results of {geocodebr} are
classified into six broad <code>precision</code> categories depending on
how exactly each input address was matched with CNEFE data. The accuracy
of the results are indicated in two columns of the output:
<code>precision</code> and <code>match_type</code>. More information
below.</p>
</div>
<div class="section level2">
<h2 id="precision-categories">Precision categories:<a class="anchor" aria-label="anchor" href="#precision-categories"></a>
</h2>
<p>The results of {geocodebr} are classified into six broad
<code>precision</code> categories:</p>
<ul>
<li>“numero”</li>
<li>“numero_interpolado”</li>
<li>“rua”</li>
<li>“cep”</li>
<li>“bairro”</li>
<li>“municipio”</li>
<li>
<code>NA</code> (not found)</li>
</ul>
<p>Each precision level can be disaggregated into more refined match
types.</p>
<div class="section level3">
<h3 id="match-type">Match Type<a class="anchor" aria-label="anchor" href="#match-type"></a>
</h3>
<p>The column <code>match_type</code> provides more refined information
on how exactly each input address was matched with CNEFE. In every
category, {geocodebr} takes the average latitude and longitude of the
addresses included in CNEFE that match the input address based on
combinations of different fields. In the strictest case, for example,
the function finds a deterministic match for all of the fields of a
given address (<code>"estado"</code>, <code>"municipio"</code>,
<code>"logradouro"</code>, <code>"numero"</code>, <code>"cep"</code>,
<code>"localidade"</code>). Think for example of a building with several
apartments that match the same street address and number. In such case,
the coordinates of the apartments will differ very slightly, and
{geocodebr} takes the average of those coordinates. In a less rigorous
example, in which only the fields (<code>"estado"</code>,
<code>"municipio"</code>, <code>"logradouro"</code>,
<code>"localidade"</code>) are matched, {geocodebr} calculates the
average coordinates of all the addresses in CNEFE along that street and
which fall within the same neighborhood.</p>
<p>The complete list of precision levels, their corresponding match type
categories and the fields considered in each category are described
below:</p>
<ul>
<li>precision: <strong>“numero”</strong>
<ul>
<li>match_type:
<ul>
<li>en01: logradouro, numero, cep e bairro</li>
<li>en02: logradouro, numero e cep</li>
<li>en03: logradouro, numero e bairro</li>
<li>en04: logradouro e numero</li>
<li>pn01: logradouro, numero, cep e bairro</li>
<li>pn02: logradouro, numero e cep</li>
<li>pn03: logradouro, numero e bairro</li>
<li>pn04: logradouro e numero</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“numero_interpolado”</strong>
<ul>
<li>match_type:
<ul>
<li>ei01: logradouro, numero, cep e bairro</li>
<li>ei02: logradouro, numero e cep</li>
<li>ei03: logradouro, numero e bairro</li>
<li>ei04: logradouro e numero</li>
<li>pi01: logradouro, numero, cep e bairro</li>
<li>pi02: logradouro, numero e cep</li>
<li>pi03: logradouro, numero e bairro</li>
<li>pi04: logradouro e numero</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“rua”</strong> (when input number is missing
‘S/N’)
<ul>
<li>match_type:
<ul>
<li>er01: logradouro, cep e bairro</li>
<li>er02: logradouro e cep</li>
<li>er03: logradouro e bairro</li>
<li>er04: logradouro</li>
<li>pr01: logradouro, cep e bairro</li>
<li>pr02: logradouro e cep</li>
<li>pr03: logradouro e bairro</li>
<li>pr04: logradouro</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“cep”</strong>
<ul>
<li>match_type:
<ul>
<li>ec01: municipio, cep, localidade</li>
<li>ec02: municipio, cep</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“bairro”</strong>
<ul>
<li>match_type:
<ul>
<li>eb01: municipio, localidade</li>
</ul>
</li>
</ul>
</li>
<li>precision: <strong>“municipio”</strong>
<ul>
<li>match_type:
<ul>
<li>em01: municipio</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong><em>Note:</em></strong> Match types starting with ‘p’ use
probabilistic matching of the logradouro field, while types starting
with ‘e’ use deterministic matching only. <strong>Match types with
probabilistic matching are not implemented in {geocodebr}
yet</strong>.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-cache">Data cache<a class="anchor" aria-label="anchor" href="#data-cache"></a>
</h2>
<p>The first time the user runs the <code><a href="../reference/geocode.html">geocode()</a></code> function,
{geocodebr} will download a few reference files and store them locally.
This way, the data only needs to be downloaded once. Mind you that these
files require approximately 4GB of space in your local drive.</p>
<p>The package includes the following functions to help users manage
cached files:</p>
<ul>
<li>
<code><a href="../reference/get_cache_dir.html">get_cache_dir()</a></code>: returns the path to where the cached
data is stored. By default, files are cached in the package
directory.</li>
<li>
<code><a href="../reference/set_cache_dir.html">set_cache_dir()</a></code>: set a custom directory to be used.
This configuration is persistent across different R sessions.</li>
<li>
<code><a href="../reference/list_cached_data.html">list_cached_data()</a></code>: list all files currently
cached</li>
<li>
<code><a href="../reference/clean_cache_dir.html">clean_cache_dir()</a></code>: delete all files of the cache
directory used by {geocodebr}</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Herszenhut, Rafael H. M. Pereira, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
